{
    "$schema": "http://schemas.microsoft.org/azure/deploymentTemplate?api-version=2015-01-01-preview#",
    "contentVersion": "1.0",
    "parameters": {
        "newOrExisitingAccount": {
            "type": "string",
            "allowedValues": [
                "New",
                "Existing"
            ],
            "metadata": {
                "description": "Select whether you want to create a new Automation account or use an existing account."
            }
        },
        "accountName": {
            "type": "string",
            "metadata": {
                "description": "The name of the Automation account to import the module to.  If you want to import your module to an existing account, make sure the resource group matches that of the existing account." 
            }
        }
    },
    "variables": {
        "templatelink": "[concat('https://raw.githubusercontent.com/QecTu/testAzure/master/', parameters('newOrExisitingAccount'), 'AccountTemplate.json')]",
        "moduleName": "Hello-WorldModule",
		"moduleUri":  "https://github.com/azureautomation/automation-packs/raw/master/101-sample-deploy-automation-resources/sample-deploy-module/modules/Hello-WorldModule.zip"
    },
    "resources": [
        {
            "apiVersion": "2015-01-01",
            "name": "nestedTemplate",
            "type": "Microsoft.Resources/deployments",
            "properties": {
                "mode": "incremental",
                "templateLink": {
                    "uri": "[variables('templatelink')]",
                    "contentVersion": "1.0"
                },
                "parameters": {
                    "accountName": {
                        "value": "[parameters('accountName')]"
                    },
                    "moduleName": {
                        "value": "[variables('moduleName')]"
                    },
                    "moduleUri": {
                        "value": "[variables('moduleUri')]"
                    }
                }
            }
        }
    ],
    "outputs": { }
}